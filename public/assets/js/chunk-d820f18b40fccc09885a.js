(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{122:function(t,s,e){"use strict";e.r(s);var a=e(6),i=e.n(a),o=e(143),l=e(160);a={data:function(){return{isLoading:!0,user:null}},props:["userid","type"],components:{EModal:o.a,CModal:l.a},mounted:function(){var t=this;i.a.post(this.$myaccount_url+this.type+"/"+this.userid).then((function(s){t.isLoading=!1,t.user=s.data.data}))},methods:{recordUpdated:function(t){var s=t.data.data;t=this.usersList.findIndex((function(t){return t.id===s.id}));this.usersList.splice(t,1,s)},recordAdded:function(t){t.data.data,t=t.data.data,this.usersList=this.usersList.concat(t)},deleteUser:function(t){var s=this;this.userToDelete=t,this.$modal.show("dialog",{title:this.$t("Delete confirmation"),text:'<span class="text-danger font-weight-bold">'+this.$t("Are you sure you want to delete this record?")+"</span>",buttons:[{title:'<span class="text-danger font-weight">'+this.$t("Delete")+"</span>",handler:function(){s.doDeleteUser(),s.$modal.hide("dialog")}},{title:this.$t("Close")}]})},doDeleteUser:function(){var t=this;this.isACModalVisible=!1,i.a.post(this.$myaccount_url+this.type+"/user/delete",{_method:"delete",user_id:this.userToDelete.id}).then((function(s){s&&(s=t.usersList.findIndex((function(s){return s===t.userToDelete})),t.$delete(t.usersList,s)),t.userToDelete=null})).catch((function(t){console.log("Error: ",t.message)}))},closeModal:function(){this.isACModalVisible=!1},edit:function(t){var s=this;this.$modal.show(("customers"==this.type?l:o).a,{userid:t,method:"update",handlers:{update:function(t){s.recordUpdated(t)}}})}}},e=e(131),a=Object(e.a)(a,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"container"},[t.isLoading?e("pre-loader"):e("div",{staticClass:"card-shadow-primary card-border mb-3 card"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3 bg-light"},[e("div",{staticClass:"p-3"},[e("div",{staticClass:"d-flex align-items-center justify-content-center mb-2 "},[e("img",{staticClass:"img-profile rounded-circle",attrs:{width:"90",src:t.user.avatar}})]),t._v(" "),e("div",{staticClass:"d-flex align-items-center justify-content-center"},[e("button",{staticClass:"btn btn-outline-primary",on:{click:function(s){return t.edit(t.user.id)}}},[e("i",{staticClass:"fas fa-user-edit"}),t._v(" "+t._s(t.$t("Edit")))])])])]),t._v(" "),e("div",{staticClass:"col"},[e("div",{staticClass:"text-center list-group list-group-flush"},[e("div",{staticClass:"list-group-item"},[t._v(t._s(t.user.name))]),t._v(" "),e("div",{staticClass:"list-group-item"},t._l(t.user.roles,(function(s,a){return e("span",{key:a,staticClass:"badge badge-primary"},[t._v("\r\n                            "+t._s(s)+"\r\n                        ")])})),0),t._v(" "),e("div",{staticClass:"list-group-item"},[t._v(t._s(t.user.email))]),t._v(" "),t.user.custom_fields?t._l(t.user.custom_fields,(function(s,a){return e("div",{key:a,staticClass:"list-group-item"},[e("span",{staticClass:"text-capitalize"},[t._v(t._s(a.replaceAll("_"," ")))]),t._v(" : "+t._s(s)+"\r\n                    ")])})):t._e(),t._v(" "),e("div",{staticClass:"list-group-item"},[t._v(t._s(t.$t("Joined on"))+" : "+t._s(t.user.created_at))]),t._v(" "),e("div",{staticClass:"list-group-item"},[t._v(t._s(t.$t("Tickets"))+" : "+t._s(t.user.total_tickets))]),t._v(" "),e("div",{staticClass:"list-group-item"},[t._v(t._s(t.$t("Last login"))+" : "+t._s(t.user.last_login_at))])],2)])])]),t._v(" "),e("v-dialog")],1)}),[],!1,null,null,null);s.default=a.exports},143:function(t,s,e){"use strict";var a=e(6),i=e.n(a);Vue.component("v-select",VueSelect.VueSelect);a={data:function(){return{fields:{user_id:null,email:null,name:null,role:null,password:null,password_confirmation:null},roles:[],isLoading:!1}},mounted:function(){Object.assign(this.$data.fields,{user_id:null,email:null,name:null,role:null,password:null,password_confirmation:null}),this.loadRoles(),"update"==this.method&&this.loadAccount()},props:{method:{type:String,default:"create",validator:function(t){return"create"===t||"update"===t}},userid:null,handlers:null},methods:{save:function(){var t=this;i.a.post(this.$myaccount_url+"employees/"+this.method,{fields:this.fields}).then((function(s){"ok"==s.data.status?(t.$toasted.global.success(s.data.message),t.method?t.handlers.update(s):t.handlers.create(s)):(s=Object.values(s.data.messages),t.$toasted.global.error(s.join("<br />")))}))},loadRoles:function(){var t=this;i.a.post(this.$myaccount_url+"roles/list",{type:"employee"}).then((function(s){s=s.data.data;var e=t.roles;s.forEach((function(t){e.push(new o(t.id,t.name))}))}))},loadAccount:function(){var t=this;"update"==this.method&&null!=this.userid&&(this.isLoading=!0,this.fields.user_id=this.userid,i.a.post(this.$myaccount_url+"employees/"+this.userid).then((function(s){s=s.data.data,t.fields.name=s.name,t.fields.email=s.email;var e=Object.keys(s.roles),a=null;t.roles.forEach((function(t){t.value==e[0]&&(a=t)})),t.fields.role=a,t.isLoading=!1})))},pwdGenerated:function(t){this.fields.password=t,this.$refs.password.type="text"}}};var o=function t(s,e){!function(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this,t),this.label=e,this.value=s};e=e(131),a=Object(e.a)(a,(function(){var t=this,s=t.$createElement;return(s=t._self._c||s)("div",{staticClass:"card"},[s("div",{staticClass:"card-header p-2"},[s("div",{staticClass:"w-100"},["create"==t.method?s("span",[t._v(t._s(t.$t("add employee")))]):s("span",[t._v(t._s(t.$t("Edit employee")))]),t._v(" "),s("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(s){return t.$emit("close")}}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])])]),t._v(" "),t.isLoading?s("div",{staticClass:"card-body"},[s("pre-loader")],1):[s("div",{staticClass:"card-body"},[s("form",{on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.save(s)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v(t._s(t.$t("Account email")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.email,expression:"fields.email"}],staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:t.$t("Account email")},domProps:{value:t.fields.email},on:{input:function(s){s.target.composing||t.$set(t.fields,"email",s.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("Name")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.name,expression:"fields.name"}],staticClass:"form-control",attrs:{type:"text",id:"name",placeholder:t.$t("Name")},domProps:{value:t.fields.name},on:{input:function(s){s.target.composing||t.$set(t.fields,"name",s.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("Account role")))]),t._v(" "),s("v-select",{attrs:{placeholder:t.$t("Choose a role"),options:t.roles},model:{value:t.fields.role,callback:function(s){t.$set(t.fields,"role",s)},expression:"fields.role"}})],1),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password"}},[t._v(t._s(t.$t("Password")))]),t._v(" "),s("div",{staticClass:"input-group mb-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.password,expression:"fields.password"}],ref:"password",staticClass:"form-control",attrs:{type:"password",placeholder:t.$t("Password"),autocomplete:"off"},domProps:{value:t.fields.password},on:{input:function(s){s.target.composing||t.$set(t.fields,"password",s.target.value)}}}),t._v(" "),s("div",{staticClass:"input-group-append"},[s("generate-password",{on:{generated:function(s){return t.pwdGenerated(s)}}})],1)]),t._v(" "),s("small",{staticClass:"form-text text-muted",attrs:{id:"passwordHelpBlock"}},[t._v(t._s(t.$t("Your password must be 8-20 characters long")))])]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"password_confirmation"}},[t._v(t._s(t.$t("Password confirmation")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.password_confirmation,expression:"fields.password_confirmation"}],staticClass:"form-control",attrs:{type:"password",id:"password_confirmation",placeholder:t.$t("Password confirmation"),autocomplete:"off"},domProps:{value:t.fields.password_confirmation},on:{input:function(s){s.target.composing||t.$set(t.fields,"password_confirmation",s.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"card-footer"},[s("div",{staticClass:"w-100"},[s("button",{staticClass:"btn btn-primary float-right",attrs:{type:"button"},on:{click:function(s){return t.save()}}},[t._v(t._s(t.$t("Save")))])])])]],2)}),[],!1,null,null,null),s.a=a.exports}}]);