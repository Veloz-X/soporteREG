(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{114:function(t,e,s){"use strict";s.r(e);var a=s(6),o=s.n(a),i=s(143);a={data:function(){return{usersList:[],isACModalVisible:!1,userToDelete:null,userToUpdate:null,userModal:"create",isLoading:!1}},components:{userModal:i.a},mounted:function(){var t=this;this.isLoading=!0,o.a.post(this.$myaccount_url+"employees/list").then((function(e){t.isLoading=!1,e.data.data,e=e.data.data,t.usersList=t.usersList.concat(e)}))},methods:{recordUpdated:function(t){var e=t.data.data;t=this.usersList.findIndex((function(t){return t.id===e.id}));this.usersList.splice(t,1,e)},recordAdded:function(t){this.usersList.unshift(t.data.data)},deleteUser:function(t){var e=this;this.userToDelete=t,this.$modal.show("dialog",{title:this.$t("Delete confirm"),text:'<span class="text-danger font-weight-bold">Are you sure you want to delete this user account? <br />this action will permanently delete the account and all data associated with it.</span>',buttons:[{title:'<span class="text-danger font-weight">Permanently delete</span>',handler:function(){e.doDeleteUser(),e.$modal.hide("dialog")}},{title:"Close"}]})},doDeleteUser:function(){var t=this;this.isACModalVisible=!1,o.a.post(this.$myaccount_url+"employees/user/delete",{_method:"delete",user_id:this.userToDelete.id}).then((function(e){e&&(e=t.usersList.findIndex((function(e){return e===t.userToDelete})),t.$delete(t.usersList,e)),t.userToDelete=null})).catch((function(t){console.log("Error: ",t.message)}))},closeModal:function(){this.isACModalVisible=!1},edit:function(t){var e=this;this.$modal.show(i.a,{userid:t,method:"update",handlers:{update:function(t){e.recordUpdated(t)}}})},addNew:function(){var t=this;this.$modal.show(i.a,{method:"create",handlers:{update:function(e){t.recordAdded(e)}}})}}},s=s(131),a=Object(s.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"d-flex justify-content-end options mb-3"},[s("button",{staticClass:"btn btn-sm btn-primary shadow-sm float-right mx-1",on:{click:t.addNew}},[s("i",{staticClass:"fas fa-plus fa-sm text-white-50"}),t._v(" "+t._s(t.$t("Add user"))+"\r\n    ")])]),t._v(" "),t.isLoading?s("pre-loader"):s("div",[t.usersList.length?s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table table-striped table-sm table-centered mb-2 border bg-white"},[s("thead",[s("tr",[s("th",[t._v(t._s(t.$t("Name")))]),t._v(" "),s("th",[t._v(t._s(t.$t("E-mail")))]),t._v(" "),s("th",[t._v(t._s(t.$t("Role")))]),t._v(" "),s("th",[t._v(t._s(t.$t("Last login")))]),t._v(" "),s("th")])]),t._v(" "),s("tbody",t._l(t.usersList,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"table-user"},[s("img",{staticClass:"mr-2 rounded-circle",attrs:{src:e.avatar,alt:e.name,width:"32"}}),t._v("\r\n                "+t._s(e.name)+"\r\n            ")]),t._v(" "),s("td",[t._v(t._s(e.email))]),t._v(" "),s("td",t._l(e.roles,(function(e){return s("span",{key:e,staticClass:"badge badge-secondary p-2 mr-1"},[t._v("\r\n                    "+t._s(t._f("capitalize")(e.replace("_"," ")))+"\r\n                ")])})),0),t._v(" "),s("td",[t._v(t._s(e.last_login_at))]),t._v(" "),s("td",{staticClass:"table-action"},[s("button",{staticClass:"btn btn-sm btn-danger btn-icon-split",attrs:{href:"#"},on:{click:function(s){return t.deleteUser(e)}}},[s("span",{staticClass:"icon text-white-50",attrs:{"data-toggle":"tooltip","data-placement":"top",title:t.$t("Delete")}},[s("i",{staticClass:"fas fa-trash"})])]),t._v(" "),s("button",{staticClass:"btn btn-sm btn-primary btn-icon-split",attrs:{href:"#","data-toggle":"modal","data-target":"#userModal"},on:{click:function(s){return t.edit(e.id)}}},[s("span",{staticClass:"icon text-white-50",attrs:{"data-toggle":"tooltip","data-placement":"top",title:t.$t("Edit")}},[s("i",{staticClass:"fas fa-user-edit"})])]),t._v(" "),s("a",{staticClass:"btn btn-sm btn-secondary btn-icon-split",attrs:{href:t.$myaccount_url+"employees/"+e.id}},[s("span",{staticClass:"icon text-white-50",attrs:{"data-toggle":"tooltip","data-placement":"top",title:t.$t("View")}},[s("i",{staticClass:"fas fa-eye"})])])])])})),0)])]):s("empty-state",{attrs:{text:"No employees yet"}})],1),t._v(" "),s("v-dialog")],1)}),[],!1,null,null,null);e.default=a.exports},131:function(t,e,s){"use strict";function a(t,e,s,a,o,i,n,l){var r,d,c="function"==typeof t?t.options:t;return e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),a&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),n?c._ssrRegister=r=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)}:o&&(r=l?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),r&&(c.functional?(c._injectStyles=r,d=c.render,c.render=function(t,e){return r.call(e),d(t,e)}):(l=c.beforeCreate,c.beforeCreate=l?[].concat(l,r):[r])),{exports:t,options:c}}s.d(e,"a",(function(){return a}))},143:function(t,e,s){"use strict";var a=s(6),o=s.n(a);Vue.component("v-select",VueSelect.VueSelect);a={data:function(){return{fields:{user_id:null,email:null,name:null,role:null,password:null,password_confirmation:null},roles:[],isLoading:!1}},mounted:function(){Object.assign(this.$data.fields,{user_id:null,email:null,name:null,role:null,password:null,password_confirmation:null}),this.loadRoles(),"update"==this.method&&this.loadAccount()},props:{method:{type:String,default:"create",validator:function(t){return"create"===t||"update"===t}},userid:null,handlers:null},methods:{save:function(){var t=this;o.a.post(this.$myaccount_url+"employees/"+this.method,{fields:this.fields}).then((function(e){"ok"==e.data.status?(t.$toasted.global.success(e.data.message),t.method?t.handlers.update(e):t.handlers.create(e)):(e=Object.values(e.data.messages),t.$toasted.global.error(e.join("<br />")))}))},loadRoles:function(){var t=this;o.a.post(this.$myaccount_url+"roles/list",{type:"employee"}).then((function(e){e=e.data.data;var s=t.roles;e.forEach((function(t){s.push(new i(t.id,t.name))}))}))},loadAccount:function(){var t=this;"update"==this.method&&null!=this.userid&&(this.isLoading=!0,this.fields.user_id=this.userid,o.a.post(this.$myaccount_url+"employees/"+this.userid).then((function(e){e=e.data.data,t.fields.name=e.name,t.fields.email=e.email;var s=Object.keys(e.roles),a=null;t.roles.forEach((function(t){t.value==s[0]&&(a=t)})),t.fields.role=a,t.isLoading=!1})))},pwdGenerated:function(t){this.fields.password=t,this.$refs.password.type="text"}}};var i=function t(e,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label=s,this.value=e};s=s(131),a=Object(s.a)(a,(function(){var t=this,e=t.$createElement;return(e=t._self._c||e)("div",{staticClass:"card"},[e("div",{staticClass:"card-header p-2"},[e("div",{staticClass:"w-100"},["create"==t.method?e("span",[t._v(t._s(t.$t("add employee")))]):e("span",[t._v(t._s(t.$t("Edit employee")))]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])])]),t._v(" "),t.isLoading?e("div",{staticClass:"card-body"},[e("pre-loader")],1):[e("div",{staticClass:"card-body"},[e("form",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save(e)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"email"}},[t._v(t._s(t.$t("Account email")))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.email,expression:"fields.email"}],staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:t.$t("Account email")},domProps:{value:t.fields.email},on:{input:function(e){e.target.composing||t.$set(t.fields,"email",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("Name")))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.name,expression:"fields.name"}],staticClass:"form-control",attrs:{type:"text",id:"name",placeholder:t.$t("Name")},domProps:{value:t.fields.name},on:{input:function(e){e.target.composing||t.$set(t.fields,"name",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v(t._s(t.$t("Account role")))]),t._v(" "),e("v-select",{attrs:{placeholder:t.$t("Choose a role"),options:t.roles},model:{value:t.fields.role,callback:function(e){t.$set(t.fields,"role",e)},expression:"fields.role"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"password"}},[t._v(t._s(t.$t("Password")))]),t._v(" "),e("div",{staticClass:"input-group mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.password,expression:"fields.password"}],ref:"password",staticClass:"form-control",attrs:{type:"password",placeholder:t.$t("Password"),autocomplete:"off"},domProps:{value:t.fields.password},on:{input:function(e){e.target.composing||t.$set(t.fields,"password",e.target.value)}}}),t._v(" "),e("div",{staticClass:"input-group-append"},[e("generate-password",{on:{generated:function(e){return t.pwdGenerated(e)}}})],1)]),t._v(" "),e("small",{staticClass:"form-text text-muted",attrs:{id:"passwordHelpBlock"}},[t._v(t._s(t.$t("Your password must be 8-20 characters long")))])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"password_confirmation"}},[t._v(t._s(t.$t("Password confirmation")))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fields.password_confirmation,expression:"fields.password_confirmation"}],staticClass:"form-control",attrs:{type:"password",id:"password_confirmation",placeholder:t.$t("Password confirmation"),autocomplete:"off"},domProps:{value:t.fields.password_confirmation},on:{input:function(e){e.target.composing||t.$set(t.fields,"password_confirmation",e.target.value)}}})])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("div",{staticClass:"w-100"},[e("button",{staticClass:"btn btn-primary float-right",attrs:{type:"button"},on:{click:function(e){return t.save()}}},[t._v(t._s(t.$t("Save")))])])])]],2)}),[],!1,null,null,null),e.a=a.exports}}]);