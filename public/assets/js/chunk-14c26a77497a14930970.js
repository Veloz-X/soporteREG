(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{107:function(t,e,a){"use strict";a.r(e);var i={data:function(){return{}},props:["ticket"],methods:{fileIcon:function(t){return"pdf"==this.fileType(t)?"fa-file-pdf":"image"==this.fileType(t)?"fa-file-image":"doc"==this.fileType(t)?"fa-file-word":"zip"==this.fileType(t)?"fa-file-archive":"fa-file"},fileType:function(t){return t.includes("application/pdf")?"pdf":t.includes("image")?"image":t.includes("officedocument")?"doc":t.includes("zip")?"zip":null}}},s=a(131),n=Object(s.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card sticky-section-item"},[a("h6",{staticClass:"card-header"},[t._v(t._s(t.$t("Ticket details")))]),t._v(" "),a("div",{staticClass:"card-body p-1"},[a("ul",{staticClass:"list-group list-group-flush"},[a("li",{staticClass:"list-group-item p-2"},[a("i",{staticClass:"far fa-folder"}),t._v("\n          "+t._s(t.$t("Category"))+" :\n          "),a("strong",[t._v(t._s(t.ticket.category.name))])]),t._v(" "),a("li",{staticClass:"list-group-item p-2"},[a("i",{staticClass:"far fa-user"}),t._v("\n          "+t._s(t.$t("Assigned to"))+"\n          "),a("strong",[t._v(t._s(t.ticket.assigned_to.name))])]),t._v(" "),a("li",{staticClass:"list-group-item p-2"},[a("i",{staticClass:"fas fa-layer-group"}),t._v("\n          "+t._s(t.$t("Priority"))+"\n          "),a("strong",{class:"ticket-priority level-"+t.ticket.priority},[t._v(t._s(t.ticket.priority))])]),t._v(" "),a("li",{staticClass:"list-group-item p-2"},[a("i",{staticClass:"far fa-clock"}),t._v("\n          "+t._s(t.$t("Submitted on"))+"\n          "),a("div",[a("small",[t._v(t._s(t.ticket.submitted_on))])])])]),t._v(" "),t.ticket.attachments.length?a("div",[a("div",[t._v(t._s(t.$t("Attachments")))]),t._v(" "),t._l(t.ticket.attachments,(function(e,i){return[["image","pdf"].includes(t.fileType(e.file_type))?a("fancy-box",{key:i,staticClass:"btn btn-outline-secondary mb-1 mr-1 btn-sm attachment",attrs:{href:e.url,target:"_blank","data-fancybox":"gallery"}},[a("i",{staticClass:"far fa",class:t.fileIcon(e.file_type)})]):a("a",{key:i,staticClass:"btn btn-outline-secondary mb-1 mr-1 btn-sm attachment",attrs:{href:e.url}},[a("i",{staticClass:"far fa",class:t.fileIcon(e.file_type)})])]}))],2):t._e()])])}),[],!1,null,null,null).exports,c=(i=a(6),a.n(i));i={data:function(){return{conversation:[],next_page:1,editorContent:null,editorValue:null,isLoading:!0}},props:["ticketid","type","ticketStatus"],methods:{loadConversation:function(t){var e=this;this.isLoading=!0,c.a.get(t).then((function(t){var a=t.data.data;e.conversation=e.conversation.concat(a),e.next_page=t.data.links.next,e.isLoading=!1,e.addLinkToImage()})).catch((function(t){console.log(t)}))},addLinkToImage:function(){jQuery(".ticket-reply-content img").each((function(){var t,e=jQuery(this);"A"!=this.parentElement.tagName&&(t=jQuery("<a />",{href:e.attr("src"),"data-lightbox":"Article image"}),e.wrap(t))}))},save:function(t){var e=this;this.$toasted.clear(),this.editorContent||"solved"==t||"closed"==t?c.a.post(this.$myaccount_url+"tickets/conversation/add",{ticket_id:this.ticketid,content:this.editorContent,status:t}).then((function(a){var i,s;"ok"==a.data.status?(e.$refs.editor.econtent=null,e.editorContent="",e.$toasted.global.success(e.$t("Ticket has been updated.")),a.data.data&&(i=a.data.data,s=e.conversation,e.conversation=[].concat(i,s)),e.$emit("update",t)):a.data.status&&"fail"==a.data.status?Array.isArray(a.data.message)?e.$toasted.global.error(Object.values(a.data.message).join("<br />")):e.$toasted.global.error(a.data.message):e.$toasted.global.error(e.$t("Failed to submit your reply, Please try again."))})):this.$toasted.global.error(this.$t("Please type a reply"))},fileIcon:function(t){return"pdf"==this.fileType(t)?"fa-file-pdf":"image"==this.fileType(t)?"fa-file-image":"doc"==this.fileType(t)?"fa-file-word":"zip"==this.fileType(t)?"fa-file-archive":"fa-file"},fileType:function(t){return t.includes("application/pdf")?"pdf":t.includes("image")?"image":t.includes("officedocument")?"doc":t.includes("zip")?"zip":null}},mounted:function(){this.loadConversation(this.$myaccount_url+"tickets/"+this.ticketid+"/conversation")}},a(183),i=Object(s.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-0"},["closed"==t.ticketStatus?a("div",{staticClass:"ticket-closed alert alert-secondary m-4"},[t._v("\n        "+t._s(t.$t("This ticket is closed and can not reopened or updated."))+"\n    ")]):a("div",{staticClass:"editor m-3 clearfix"},[a("text-editor",{ref:"editor",attrs:{uploadtype:"ticket",placeholder:t.$t("Add a reply")+"..."},model:{value:t.editorContent,callback:function(e){t.editorContent=e},expression:"editorContent"}}),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"float-right mt-3"},[a("div",{staticClass:"input-group"},[a("div",{staticClass:"input-group-prepend"},[a("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",disabled:!t.editorContent},on:{click:function(e){return t.save("open")}}},[t._v("\n                  "+t._s(t.$t("Submit as"))+" "),a("strong",[t._v(t._s(t.$t("Open")))])])]),t._v(" "),a("div",{staticClass:"input-group-append"},[t._m(0),t._v(" "),a("div",{staticClass:"dropdown-menu"},[a("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(e){return t.save("solved")}}},[t._v("\n                    "+t._s(t.$t("Resolved"))+"\n                  ")])])])])])])])],1),t._v(" "),a("div",[a("transition-group",{attrs:{name:"fade",mode:"out-in"}},t._l(t.conversation,(function(e){return a("div",{key:e.id,staticClass:"ticket-c",class:{"my-msg":e.is_owner}},[a("hr",{staticClass:"m-0"}),t._v(" "),a("div",{staticClass:"media p-2 c-item ticket-reply-item"},[a("div",{staticClass:"media-body"},[a("div",[a("img",{staticClass:"mr-3 bd-placeholder-img rounded rounded-circle float-left",attrs:{width:"40",height:"40",src:e.user.avatar,alt:e.user.name}}),t._v(" "),a("div",[a("span",{staticClass:"h5 my-0 d-block text-capitalize"},[t._v(t._s(e.user.name))]),t._v(" "),a("small",{staticClass:"text-muted mb-2 d-block"},[t._v(t._s(e.created_at))])])]),t._v(" "),a("div",{staticClass:"ticket-reply-content"},[a("p",{staticClass:"c-msg",domProps:{innerHTML:t._s(e.content)}},[t._v(t._s(e.content))])]),t._v(" "),e.attachments&&e.attachments.length?a("div",{staticClass:"reply-attachments mt-4 pt-2"},[a("div",[t._v(t._s(t.$t("Ticket attachments")))]),t._v(" "),t._l(e.attachments,(function(e,i){return[["image","pdf"].includes(t.fileType(e.file_type))?a("fancy-box",{key:i,staticClass:"btn btn-outline-secondary mb-1 btn-sm attachment",attrs:{href:e.url,target:"_blank","data-fancybox":"gallery"}},[a("i",{staticClass:"far fa-2x",class:t.fileIcon(e.file_type)})]):a("a",{key:i,staticClass:"btn btn-outline-secondary mb-1 btn-sm attachment",attrs:{href:e.url}},[a("i",{staticClass:"far fa-2x",class:t.fileIcon(e.file_type)})])]}))],2):t._e(),t._v(" "),e.user.signature?a("div",{staticClass:"user-signature"},[t._v(t._s(e.user.signature))]):t._e()])])])})),0),t._v(" "),t.isLoading?a("pre-loader"):t._e(),t._v(" "),t.next_page&&!t.isLoading?a("div",{staticClass:"text-center p-2"},[a("button",{staticClass:"btn btn-outline-secondary",on:{click:function(e){return t.loadConversation(t.next_page)}}},[t._v("\n          "+t._s(t.$t("Load more"))+"\n        ")])]):t._e()],1)])])}),[function(){var t=this,e=t.$createElement;return(e=t._self._c||e)("button",{staticClass:"btn btn-outline-primary dropdown-toggle dropdown-toggle-split",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e("span",{staticClass:"sr-only"},[t._v("Toggle Dropdown")])])}],!1,null,null,null).exports,a(148),a(149),i={data:function(){return{ticket:null,isLoading:!0}},mounted:function(){this.loadTicket()},components:{TicketWidget:n,TicketConversation:i},props:{ticketid:Number},methods:{loadTicket:function(){var t=this;c.a.post(this.$myaccount_url+"tickets/"+this.ticketid).then((function(e){t.ticket=e.data.data,t.isLoading=!1}))},ticketUpdated:function(t){this.ticket.status=t}}},i=Object(s.a)(i,(function(){var t=this,e=t.$createElement;return(e=t._self._c||e)("div",[t.ticket?e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4 sticky-section"},[e("TicketWidget",{attrs:{ticket:t.ticket}})],1),t._v(" "),e("div",{staticClass:"col-md-8 mb-2"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"my-3"},[e("span",{staticClass:"h4"},[t._v(t._s(t.ticket.title))]),t._v(" "),e("span",{class:"badge badge-ticket-"+t.ticket.status},[t._v(t._s(t.ticket.status))]),t._v(" "),e("div",{staticClass:"float-right"},[e("small",[t._v(t._s(t.$t("Ticket ID"))+" : #"+t._s(t.ticketid))])])])]),t._v(" "),e("div",{staticClass:"col-md-12"},[e("TicketConversation",{attrs:{ticketStatus:t.ticket.status,ticketid:t.ticketid},on:{update:function(e){t.ticket.status=e}}})],1)])])]):e("pre-loader")],1)}),[],!1,null,null,null),e.default=i.exports},157:function(t,e,a){var i=a(184);"string"==typeof i&&(i=[[t.i,i,""]]);a(133)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(t.exports=i.locals)},183:function(t,e,a){"use strict";a(157)},184:function(t,e,a){(t.exports=a(132)(!1)).push([t.i,"\n.ticket-reply-item img,\r\n.ticket-reply-item video {\r\n  max-width: 100%;\r\n  height: auto;\n}\n.my-msg {\r\n  background: #2196f30f;\n}\n.reply-attachments .btn.attachment{\r\n    padding: 0.5em 0.5em;\r\n    font-size: 0.7em;\r\n    border: none;\r\n    margin: 0 3px;\r\n    color: #7d7d7d;\n}\n.reply-attachments .btn.attachment:hover{\r\n    background: white;\n}\n.reply-attachments {\r\n    border-top: 1px dashed #0000002b;\n}\r\n\r\n\r\n",""])}}]);