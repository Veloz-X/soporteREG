(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{195:function(t,a,e){"use strict";e.r(a);var s=e(6),i=e.n(s);Vue.component("v-select",VueSelect.VueSelect),s={data:function(){return{title:"",url:null,listLanguages:[],editorContent:"",tags:[],featured:0,published:0,listCategories:[{title:""}],isLoading:!1,selectedLanguage:null,currentLanguage:null,selectedCategory:null,selectedTags:[],confirmReload:!1}},methods:{save:function(t){var a=this;this.$toasted.clear(),this.title?this.selectedCategory?this.selectedLanguage?i.a.post(this.$myaccount_url+"manage_articles",{title:this.title,content:this.editorContent,tags:this.selectedTags,language:this.selectedLanguage.code,_method:null==this.article_id?"post":"put",article_id:this.article_id,category:null==this.selectedCategory?0:this.selectedCategory.id,published:t,featured:1==this.featured?1:0}).then((function(t){"undefined"!=t.data.data&&(a.$toasted.global.success(a.$t("article_saved")),a.listTags(),a.article_id||(window.location.href=a.$myaccount_url+"#/articles/edit/"+t.data.data.id)),a.confirmReload=!1})).catch((function(t){a.$showError(t)})):this.$toasted.global.error(this.$t("lang_must_be_selected")):this.$toasted.global.error(this.$t("category_must_be_selected")):this.$toasted.global.error(this.$t("title_can_not_be_empty"))},loadRecord:function(){var t=this;this.article_id&&(this.isLoading=!0,i.a.post(this.$myaccount_url+"manage_articles/show/"+this.article_id,{language:this.selectedLanguage?this.selectedLanguage.code:null}).then((function(a){t.title=a.data.data.title,t.url=a.data.data.url,t.featured=a.data.data.featured,t.published=a.data.data.published,t.selectedTags=a.data.data.tags,t.language=a.data.data.language,t.selectedCategory=a.data.data.category,t.editorContent=a.data.data.content||"",a=t.listLanguages.findIndex((function(a){return a.code===t.language})),t.selectedLanguage=t.listLanguages[a],t.confirmReload=!1})).catch((function(a){t.$showError(a)})).finally((function(){t.isLoading=!1})))},listTags:function(){var t=this;this.isLoading=!0,i.a.post(this.$myaccount_url+"tags").then((function(a){t.tags=a.data.data})).catch((function(a){t.$showError(a)})).finally((function(){t.isLoading=!1}))},loadCategories:function(){var t=this;this.isLoading=!0,i.a.get(this.$myaccount_url+"manage_categories/fetch").then((function(a){t.listCategories=a.data.data})).catch((function(a){t.$showError(a)})).finally((function(){t.isLoading=!1}))},autoFocus:function(){var t=this;this.$nextTick((function(){t.$refs.tags.$refs.search.focus()}))},autosave:function(){this.article_id},languages:function(){var t=this;this.isLoading=!0,i.a.post(this.$myaccount_url+"available_languages").then((function(a){t.listLanguages=Object.entries(a.data).map((function(t){return{code:t[0],name:t[1]}})),a=t.listLanguages.findIndex((function(a){return a.code===t.locale})),t.selectedLanguage=t.listLanguages[a]})).catch((function(a){t.$showError(a)})).finally((function(){t.isLoading=!1}))}},mounted:function(){this.selectedLanguage={code:this.locale},this.languages(),this.listTags(),this.loadCategories(),this.article_id&&this.loadRecord(),this.confirmReload=!1},props:["article_id","locale"],watch:{editorContent:function(t,a){this.isLoading||t==a||""==t||(this.confirmReload=!0)},title:function(t,a){this.isLoading||t==a||""==t||(this.confirmReload=!0)},selectedCategory:function(t,a){!this.isLoading&&t!=a&&t&&(this.confirmReload=!0)},featured:function(t,a){this.isLoading||t==a||(this.confirmReload=!0)},selectedLanguage:function(t,a){if(this.currentLanguage!=this.selectedLanguage&&null!=this.currentLanguage&&t!=this.currentLanguage&&this.confirmReload&&!confirm(this.$t("Reload article confirmation")))return this.selectedLanguage=a,!1;this.currentLanguage=t,this.loadRecord()}}},e=e(131),s=Object(e.a)(s,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t.isLoading?e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("pre-loader")],1)]):e("div",[e("div",{staticClass:"clearfix"},[e("div",{staticClass:"my-2 float-left"},[e("router-link",{staticClass:"btn btn-sm btn-outline-secondary mr-2",attrs:{to:{name:"articles_list"}}},[e("i",{staticClass:"fas fa-angle-left"}),t._v(" "+t._s(t.$t("manage_articles"))+"\n        ")])],1),t._v(" "),t.article_id?e("div",{staticClass:"my-2 float-right"},[e("a",{staticClass:"btn btn-sm btn-outline-secondary mr-2",attrs:{href:t.url}},[e("i",{staticClass:"fas fa-eye"}),t._v(" "+t._s(t.$t("view"))+"\n        ")])]):t._e()]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12 col-md-4 col-lg-3"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body p-3"},[e("div",{staticClass:"form-group"},[t._v("\n              "+t._s(t.$t("Category"))+"\n              "),e("v-select",{attrs:{placeholder:t.$t("Attach to a category"),label:"name",options:t.listCategories},on:{blur:function(a){return t.autosave()}},scopedSlots:t._u([{key:"option",fn:function(a){return[a.thumbnail?e("img",{attrs:{src:a.thumbnail,width:"20",height:"20"}}):e("i",{staticClass:"far fa-folder fa-lg"}),t._v("\n                  "+t._s(a.name)+"\n                ")]}}]),model:{value:t.selectedCategory,callback:function(a){t.selectedCategory=a},expression:"selectedCategory"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[t._v("\n              "+t._s(t.$t("tags"))+"\n              "),e("v-select",{ref:"tags",attrs:{placeholder:t.$t("Add tags"),options:t.tags,multiple:"",taggable:""},on:{blur:function(a){return t.autosave()},input:function(a){return t.autoFocus()}},model:{value:t.selectedTags,callback:function(a){t.selectedTags=a},expression:"selectedTags"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"custom-control custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.featured,expression:"featured"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"is_featured"},domProps:{checked:1==t.featured,checked:Array.isArray(t.featured)?-1<t._i(t.featured,null):t.featured},on:{blur:function(a){return t.autosave()},change:function(a){var e=t.featured,s=a.target,i=!!s.checked;Array.isArray(e)?(a=t._i(e,null),s.checked?a<0&&(t.featured=e.concat([null])):-1<a&&(t.featured=e.slice(0,a).concat(e.slice(a+1)))):t.featured=i}}}),t._v(" "),e("label",{staticClass:"custom-control-label",attrs:{for:"is_featured"}},[t._v(t._s(t.$t("Featured")))])]),t._v(" "),e("span",{staticClass:"help-block"},[e("small",[t._v(t._s(t.$t("Featured articles are displayed on the home page")))])])]),t._v(" "),e("div",[e("div",{staticClass:"form-group d-inline my-1"},[e("button",{staticClass:"btn btn-outline-primary my-1",attrs:{type:"submit"},on:{click:function(a){return t.save(1)}}},[e("i",{staticClass:"far fa-save"}),t._v(" "+t._s(t.$t("Save & publish"))+"\n                ")])]),t._v(" "),e("div",{staticClass:"form-group d-inline my-1"},[e("button",{staticClass:"btn btn-outline-primary my-1",attrs:{type:"submit"},on:{click:function(a){return t.save(0)}}},[e("i",{staticClass:"far fa-save"}),t._v(" "+t._s(t.$t("Draft"))+"\n                ")])])])])])]),t._v(" "),e("div",{staticClass:"col-sm-12 col-md-8 col-lg-9"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body p-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("v-select",{attrs:{placeholder:t.$t("Article language"),label:"name",options:t.listLanguages},model:{value:t.selectedLanguage,callback:function(a){t.selectedLanguage=a},expression:"selectedLanguage"}})],1)]),t._v(" "),e("div",{staticClass:"col"},[e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control",attrs:{type:"text",id:"article-title",placeholder:t.$t("Article Title")},domProps:{value:t.title},on:{blur:function(a){return t.autosave()},input:function(a){a.target.composing||(t.title=a.target.value)}}})])])]),t._v(" "),e("div",{staticClass:"form-groups"},[e("div",{staticClass:"card shadow-none"},[e("div",{staticClass:"card-body p-0"},[e("text-editor",{attrs:{options:"full",uploadtype:"article",placeholder:t.$t("Article content")+"..."},on:{blur:function(a){return t.autosave()}},model:{value:t.editorContent,callback:function(a){t.editorContent=a},expression:"editorContent"}})],1)])])])])])])])])}),[],!1,null,null,null),a.default=s.exports}}]);